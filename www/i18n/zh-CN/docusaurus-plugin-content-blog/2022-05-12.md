---
slug: build-with-docusaurus
title: "#11: Share Content - with Docusaurus"
authors: [nitya]
tags: [swa, 30days, usage-examples, react, docusaurus]
draft: false 
---

欢迎来到 **#30DaysOfSWA** 的 `第2周第4天`！！

今天是个特别的日子——[Azure Static Web Apps 发布一周年](https://azure.microsoft.com/en-us/updates/azure-static-web-apps-is-now-generally-available/?WT.mc_id=30daysofswa-61155-cxall)！<br/> **SWA 生日快乐！🎂**

我想用特别的方式来庆祝，正好有个绝妙的主意！让我们使用 [Docusaurus](https://docusaurus.io/) 创建一个内容型静态网站，并通过 [Azure Static Web Apps](https://docs.microsoft.com/en-us/azure/static-web-apps/?WT.mc_id=30daysofswa-61155-cxall) 部署它。想了解能用 Docusaurus 构建哪些静态网站？[查看他们的展示案例](https://docusaurus.io/showcase)！

为什么选择**这个**演示？因为它非常“元”（双关语）。你可能已经注意到 [#30DaysOfSWA](https://aka.ms/30DaysOfSWA) 网站就是用 Docusaurus 构建的。🦖

通过分享这个教程，我希望激励更多人构建/部署展示自己技术旅程的网站——无论是记录 #30Days 学习历程，还是展示 #100Devs 作品集。#现在开始吧！🎉

## 内容概览

* **简介**: 什么是 Docusaurus？
 * **快速入门**: 搭建经典站点
 * **配置**: `docusaurus.config.js`
 * **部署**: Azure Static Web Apps
 * **定制**: 主题与插件
 * **练习**: 尝试扩展演示项目

![](../static/img/series/11-banner.png)

---

## 关于演示

在今天的教程中，我们将创建一个 Docusaurus 经典站点，部署到 Azure Static Web Apps，然后修改站点内容来验证其自动重建和部署的能力。我希望最终能将其贡献给 Docusaurus 文档作为 Azure 部署范例——欢迎提出改进建议！

* 🌟 [GitHub 上的教程源码](https://github.com/fearlessly-dev/swa-demo-docusaurus)——我会持续更新**该版本**
* 🎉  [Azure Static Web Apps 上的实时站点](https://zealous-bay-0062c640f.1.azurestaticapps.net/)——仅用于演示

## 什么是 Docusaurus？

Docusaurus 是 Meta 开源的静态网站生成器，可帮助构建、部署和维护开源项目网站。它在 2021 年被评为 JavaScript 生态中[上升最快的](https://docusaurus.io/)三大静态站点生成器之一，具有以下吸引人的特性：

* 内置搜索、本地化和版本控制支持
 * 支持 MDX（JSX 风格的 Markdown）实现更丰富的内容
 * 提供主题和插件系统扩展默认功能
 * 基于 React 构建，可通过自定义组件扩展

阅读其[文档](https://docusaurus.io/docs)并查看[展示案例](https://docusaurus.io/showcase)了解实际应用。现在让我们开始构建演示项目。

---

## 1. 搭建站点

1. 在仓库的专用文件夹(`www`)中搭建 Docusaurus 站点（使用`classic`主题）。该命令会自动安装所需包及其依赖项。

```bash
 npx create-docusaurus@latest www classic
```

2. 查看生成的文件结构。以下输出经过简化以便阅读。

```
ls -l www/

README.md   
babel.config.js 
blog/              
docs/    
docusaurus.config.js               
node_modules/        
package-lock.json    
package.json           
sidebars.js                 
src/                  
static/    
```

3. 让我们在本地预览站点，验证是否成功。

```bash
cd www
npx docusaurus start

[INFO] Starting the development server...
[SUCCESS] Docusaurus website is running at http://localhost:3000/.
```

您应该会看到类似这样的界面——这是脚手架生成的Docusaurus站点默认首页。

![Landing Page](../static/img/series/11-landing.png)

4. 开发服务器支持热重载。尝试修改站点源代码——例如编辑`docusaurus.config.js`文件，将`title`改为**"我的静态Web应用站点"**。您会立即在预览中看到变化：

![Landing Page Reloaded](../static/img/series/11-reload.png)

5. 现在可以通过以下命令构建**生产环境就绪**的站点版本。注意静态文件会生成在**build/**目录下。

```bash
cd www/
npm run build
..
..
[SUCCESS] Generated static files in "build".
[INFO] Use `npm run serve` command to test your build locally.
```

---

## 2. 部署到Azure

Docusaurus基于React构建——因此在部署到Azure静态Web应用时，可以使用[相同的配置设置](https://docs.microsoft.com/en-us/azure/static-web-apps/front-end-frameworks)。

您有三种入门选择：

* 通过浏览器使用[Azure门户快速入门](https://docs.microsoft.com/en-us/azure/static-web-apps/getting-started?tabs=react)
  * 通过终端使用[Azure CLI快速入门](https://docs.microsoft.com/en-us/azure/static-web-apps/get-started-cli?tabs=vanilla-javascript)
  * 通过IDE使用[VS Code扩展快速入门](https://docs.microsoft.com/en-us/azure/static-web-apps/getting-started?tabs=vanilla-javascript)

若选择第一种方式，点击按钮跳转至Azure门户后，请按照[快速入门](https://docs.microsoft.com/en-us/azure/static-web-apps/getting-started?tabs=react)指南操作，但使用*本项目*的详细信息。

[![Deploy to Azure button](https://aka.ms/deploytoazurebutton)](https://portal.azure.com/?feature.customportal=false&WT.mc_id=30daysofswa-61155-cxall#create/Microsoft.StaticApp)

## 3... 使用VS Code

我将使用[Visual Studio Code扩展](https://docs.microsoft.com/en-us/azure/static-web-apps/getting-started?tabs=vanilla-javascript)通过几次点击完成部署。

整个过程都在VS Code窗口内完成，从开始到结束只需几分钟——_并全程提供引导提示_。为方便起见，我已通过截图逐步记录（图片适用于_VS Code 1.66.2版本_）。

## 3.1 安装扩展

在项目仓库目录中打开Visual Studio Code (IDE)。访问此页面点击"安装"，安装[Azure静态Web应用扩展](https://marketplace.visualstudio.com/items?itemName=ms-azuretools.vscode-azurestaticwebapps)。

![VS Code Extension for SWA](../static/img/series/11-extension.png)

## 3.2 定位SWA面板

扩展安装完成后，您将在VS Code编辑器中看到此窗口，确认已准备就绪。

![VS Code Extension Installed](../static/img/series/11-vscode.png)

您会在"Azure"分类下找到Azure静态Web应用选项。

该扩展的[文档页面](https://marketplace.visualstudio.com/items?itemName=ms-azuretools.vscode-azurestaticwebapps)及其[GitHub页面](https://github.com/microsoft/vscode-azurestaticwebapps/wiki/Creating-a-Static-Web-App)均提供了详细的操作指南——请查阅这些资源以获取最新流程。我们将首先点击VS Code侧边栏中的_Azure_图标，然后向下滚动直至看到`Static Web Apps`部分。

## 3.3 创建静态Web应用

点击"+"按钮启动**创建静态Web应用**流程。

![激活SWA扩展](../static/img/series/11-swa-plus.png)

_"创建静态Web应用"_流程将为您创建（并提交）一个GitHub Actions工作流，该工作流会从代码库源头自动构建和部署您的站点，并在未来所有代码变更时生效。

因此如果您有_当前待提交的代码变更_，系统会首先提示您提交这些更改！让我们完成这一步！

![提交变更](../static/img/series/11-commit.png)

## 3.4 配置SWA

扩展将引导您完成下图所示的五个步骤，每个步骤都已预先填充默认值。请根据本项目需求进行如下自定义配置：

| Screenshot | Step |
|:---|:---|
| ![Step 1](../static/img/series/11-swa-1.png)<br/> | Specify project name |
| ![Step 2](../static/img/series/11-swa-2.png) <br/>| Pick Azure region to deploy it in |
| ![Step 3](../static/img/series/11-swa-3.png)<br/> | Pick framework used by app |
| ![Step 4](../static/img/series/11-swa-4.png)<br/> | Specify folder contaning site source |
| ![Step 5](../static/img/series/11-swa-5.png)<br/> | Specify folder where site gets built by default |
| | |

## 3.5 跟踪进度

几秒钟后，您将看到此提示——这表示工作流正在**为您创建并提交GitHub Actions构建/部署工作流YAML文件**。🎉

![已创建](../static/img/series/11-swa-created.png)

如果立即查看代码仓库，您会发现[相关提交记录](https://github.com/fearlessly-dev/swa-demo-docusaurus/commit/1005a16c10bbbce51c8526a3c14253d1aec1a59c)和[已激活的Actions流程](https://github.com/fearlessly-dev/swa-demo-docusaurus/actions/runs/2313039968)（标记为`ci: add Azure Static Web Apps worfklow`）正在运行。

您还可以直接在VS Code侧边栏的`Static Web Apps`部分跟踪应用进度和配置设置。_找到项目名称并展开内容..._

![侧边栏](../static/img/series/11-swa-sidebar.png)

## 3.6 浏览站点！

再过几秒钟，您将收到此提示：

![已部署](../static/img/series/11-swa-deployed.png)

现在前往侧边栏中您的项目部分，右键点击项目名称查看可用菜单选项：

![浏览](../static/img/series/11-swa-browse.png)

点击"浏览站点"即可访问已部署的Docusaurus网站！就这样！只需几次点击和默认配置调整——大功告成！

---

## 4. 自定义配置

此时，您可以对站点源码进行任意修改，提交变更后——无需任何额外操作即可自动重建和部署站点！

以下是一些尝试建议：

* 自定义[样式或布局](https://docusaurus.io/docs/styling-layout)
 * 探索SEO、搜索等[插件功能](https://docusaurus.io/docs/api/plugins)
 * 尝试在内容中[创建/使用MDX](https://docusaurus.io/docs/markdown-features/react#using-jsx-in-markdown)

我对`docusaurus.config.js`文件做了一些示例修改，使着陆页内容更符合我的个性化需求。

我还更新了 `src/css/custom.css` 文件以适配新的深色/浅色模式主题色，并替换了 `logo.svg` 文件。

提交这些更改后，部署的站点将自动重建更新。以下是我在本地预览时的效果，提交更改前的状态。

|Light Mode |  Dark Mode|
|:---|:---|
|![Light Mode](../static/img/series/11-swa-light.png)|![Dark Mode](../static/img/series/11-swa-dark.png) |

---

🎉  **成果展示: 站点已[通过 Azure Static Web Apps 实时发布](https://zealous-bay-0062c640f.1.azurestaticapps.net/)**

---

## 实践任务

您已看到我对站点进行的几项定制。现在轮到您了！以下是几个可供尝试的挑战：

* 完成教程部署您自己的站点！
 * 尝试 Docusaurus 定制：**添加一个 MDX 组件！**
 * 尝试 SWA 定制：**添加 API 获取内容！**
 * 尝试 SWA 定制：**通过 Twitter 添加身份验证功能并实际使用！**

## 资源：

* [Docusaurus](https://docusaurus.io/) - 官方文档
 * [Azure Static Web Apps (SWA)](https://docs.microsoft.com/en-us/azure/static-web-apps/) - 官方文档
 * [#30DaysOfSWA](https://aka.ms/30DaysOfSWA) - SWA 功能导览