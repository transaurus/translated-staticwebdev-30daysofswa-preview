---
slug: previewing-swa
title: "#06: Previewing SWA"
authors: [nitya, michail]
tags: [swa, 30days, core-concepts]
draft: false
---

æ¬¢è¿æ¥åˆ° **#30DaysOfSWA** çš„ç¬¬1å‘¨ç¬¬6å¤©ï¼ï¼

æˆ‘ä»¬å³å°†å®Œæˆç¬¬ä¸€å‘¨çš„å­¦ä¹ ï¼ï¼ğŸ‰

æˆªè‡³ç›®å‰ï¼Œæˆ‘ä»¬å·²ç»å­¦ä¹ äº†å¦‚ä½•åˆ©ç”¨_é™æ€èµ„äº§æ‰˜ç®¡_(Azure Static Web Apps)å’Œ_æ— æœåŠ¡å™¨API_(Azure Functions)åŠŸèƒ½æ¥æ„å»ºå¹¶éƒ¨ç½²ä¸€ä¸ªå…·å¤‡å¯æ‰©å±•æ€§å’Œæˆæœ¬æ•ˆç›Šçš„Webåº”ç”¨ç¨‹åºã€‚æˆ‘ä»¬è¿˜å­¦ä¼šäº†å¦‚ä½•æ ¹æ®éœ€æ±‚_é…ç½®_å’Œ_ä¿æŠ¤_é™æ€Webåº”ç”¨ã€‚é‚£ä¹ˆè¿˜æœ‰ä»€ä¹ˆéœ€è¦æ¢è®¨çš„å‘¢ï¼Ÿ

**éƒ¨ç½²**é€‰é¡¹ï¼Ÿè®©æˆ‘ä»¬å¼€å§‹å§ï¼æ­¤å‰æˆ‘ä»¬è®¨è®ºçš„æ˜¯é»˜è®¤ä½“éªŒï¼šä»_ç”Ÿäº§_åˆ†æ”¯éƒ¨ç½²ï¼Œä½¿ç”¨_GitHub_ Actionså®ç°CI/CDã€‚ä½†å¦‚ä½•åœ¨ç”Ÿäº§éƒ¨ç½²å‰**é¢„è§ˆ**é™æ€Webåº”ç”¨ï¼Ÿæˆ‘ä»¬å°†æ¢è®¨å¦‚ä½•åœ¨æ‹‰å–è¯·æ±‚ä¸­é¢„è§ˆSWAã€åœ¨éç”Ÿäº§åˆ†æ”¯é¢„è§ˆï¼Œä»¥åŠé€šè¿‡é¢„é…ç½®çš„å‘½åç¯å¢ƒä½¿æˆ‘ä»¬çš„é¢„å‘å¸ƒå·¥ä½œæµæ›´é«˜æ•ˆã€‚

## ä»Šæ—¥è¦ç‚¹

* SWAæ”¯æŒå“ªäº›éƒ¨ç½²ç±»å‹ï¼Ÿ
 * _é¢„è§ˆåŠŸèƒ½_ï¼šåœ¨æ‹‰å–è¯·æ±‚ä¸­
 * _é¢„è§ˆåŠŸèƒ½_ï¼šåœ¨éç”Ÿäº§åˆ†æ”¯
 * _é¢„è§ˆåŠŸèƒ½_ï¼šåœ¨å‘½åç¯å¢ƒä¸­
 * _éƒ¨ç½²åŠŸèƒ½_ï¼šåˆ°è‡ªå®šä¹‰åŸŸå
 * **å®è·µç»ƒä¹ :** [ä½¿ç”¨SWAé¢„è§ˆåŠŸèƒ½å®¡æŸ¥PR](https://docs.microsoft.com/en-us/azure/static-web-apps/review-publish-pull-requests)

![](../static/img/series/06-banner.png)

## éƒ¨ç½²ç±»å‹

å½“æˆ‘ä»¬è€ƒè™‘éƒ¨ç½²æ—¶ï¼Œé€šå¸¸æ¶‰åŠä¸¤ç±»ç¯å¢ƒï¼šä½œä¸ºå®é™…ä½¿ç”¨ä¸»å…¥å£çš„_ç”Ÿäº§ç¯å¢ƒ_ï¼Œä»¥åŠç”¨äºå†…éƒ¨æµ‹è¯•å’Œé¢„è§ˆç‰ˆæ—©æœŸéªŒè¯çš„_é¢„å‘å¸ƒç¯å¢ƒ_ã€‚

Azure Static Web Apps åŸç”Ÿæ”¯æŒå››ç§ç¯å¢ƒç±»å‹ï¼š

* _ç”Ÿäº§ç¯å¢ƒ_ï¼šè¿™æ˜¯çœŸå®ä¸–ç•Œçš„éƒ¨ç½²å…¥å£ï¼Œä¼šè¢«**æœç´¢å¼•æ“ç´¢å¼•**ï¼Œå¹¶å¯å…³è”è‡ªå®šä¹‰åŸŸåï¼ˆè‹¥å·²é…ç½®ï¼‰ã€‚
 * _æ‹‰å–è¯·æ±‚(PR)ç¯å¢ƒ_ï¼šè¿™æ˜¯ä¸ºæ‹‰å–è¯·æ±‚å»ºç«‹çš„**ä¸´æ—¶**ç¯å¢ƒï¼Œå½“PRå…³é—­æ—¶ä¼šè¢«æ‹†é™¤ã€‚
 * _åˆ†æ”¯ç¯å¢ƒ_ï¼šè¿™æ˜¯ä¸ºéç”Ÿäº§åˆ†æ”¯å»ºç«‹çš„**é•¿æœŸç¨³å®š**ç¯å¢ƒï¼ŒURLåœ¨è¯¥åˆ†æ”¯å­˜ç»­æœŸé—´ä¿æŒä¸å˜ã€‚
 * _å‘½åç¯å¢ƒ_ï¼šä¸Šè¿°ç¯å¢ƒçš„URLä¼šåæ˜ PRç¼–å·æˆ–åˆ†æ”¯åç§°ã€‚æ‚¨ä¹Ÿå¯ä»¥é…ç½®å…·æœ‰å›ºå®šåç§°çš„**ç¨³å®š**é¢„è§ˆç¯å¢ƒï¼Œå…³è”ç‰¹å®šéƒ¨ç½²ä¸Šä¸‹æ–‡ï¼ˆä¾‹å¦‚ä¸´æ—¶ç‰ˆæœ¬ï¼‰ã€‚

ç”Ÿäº§éƒ¨ç½²çš„URLæ ¼å¼ä¸º`<é»˜è®¤ä¸»æœºå>-<ç¼–å·>.azurestaticapps.net`ï¼Œå…¶ä¸­`é»˜è®¤ä¸»æœºå`å¯¹æ¯ä¸ªåº”ç”¨å”¯ä¸€ã€‚

_é¢„è§ˆ_ç¯å¢ƒçš„URLæ ¼å¼ä¸ºï¼š`<é»˜è®¤ä¸»æœºå>-<åˆ†æ”¯æˆ–ç¯å¢ƒåç§°>.<åŒºåŸŸ>.azurestaticapps.net`ï¼Œå…¶ä¸­`åŒºåŸŸ`åæ˜ éƒ¨ç½²åœ°ç†ä½ç½®ï¼Œ`åˆ†æ”¯æˆ–ç¯å¢ƒåç§°`å¯ä»¥æ˜¯åˆ†æ”¯åã€å‘½åç¯å¢ƒæˆ–æ‹‰å–è¯·æ±‚ç¼–å·ã€‚

è®©æˆ‘ä»¬ç®€è¦äº†è§£æ¯ç§ç±»å‹ã€‚

## æ‹‰å–è¯·æ±‚

å½“å‰æ‹‰å–è¯·æ±‚_é¢„è§ˆç¯å¢ƒ_ä»…é€‚ç”¨äºæ‰˜ç®¡åœ¨GitHubä¸”é…ç½®äº†GitHub Actionsçš„é¡¹ç›®ï¼š

* æ¯ä¸ªå‘å¾€_å—ç›‘æ§åˆ†æ”¯_çš„PRéƒ½ä¼šè·å¾—ä¸€ä¸ª**ä¸´æ—¶**é¢„å‘å¸ƒç¯å¢ƒï¼Œè¯¥ç¯å¢ƒåœ¨PRå…³é—­æ—¶è‡ªåŠ¨æ‹†é™¤ã€‚
  * ç”¨äºéªŒè¯å˜æ›´ã€æ‰§è¡Œå®Œæ•´æ€§æ£€æŸ¥ç­‰
  * å¦‚æœå‘å…³è”PRçš„åˆ†æ”¯æäº¤æ–°ä»£ç ï¼Œç¯å¢ƒä¼šè‡ªåŠ¨é‡å»ºéƒ¨ç½²
  * å³ä½¿GitHubä»“åº“æ˜¯ç§æœ‰çš„ï¼Œé¢„è§ˆç¯å¢ƒä¹Ÿ_å¯¹å¤–å¯è§_â€”â€”ä¸è¿‡é»˜è®¤æƒ…å†µä¸‹URLä¸æ˜“è¢«å‘ç°ï¼ˆå³ä¸è¢«æœç´¢å¼•æ“ç´¢å¼•ï¼‰

äº†è§£å¦‚ä½•[åœ¨Azure Static Web Appsä¸­é¢„è§ˆæ‹‰å–è¯·æ±‚](https://docs.microsoft.com/en-us/azure/static-web-apps/review-publish-pull-requests)ã€‚

## åˆ†æ”¯

åˆ†æ”¯çš„é¢„è§ˆç¯å¢ƒå°†æ‹¥æœ‰**ç¨³å®š**çš„URLã€‚åœ¨ç›¸å…³çš„_GitHub Actions_æˆ–_Azure Pipelines_å·¥ä½œæµæ–‡ä»¶ä¸­è¿›è¡Œé…ç½®ï¼Œå¦‚[æ­¤ç¤ºä¾‹æ‰€ç¤º](https://docs.microsoft.com/en-us/azure/static-web-apps/branch-environments?tabs=github-actions#example)ã€‚

ä¾‹å¦‚ï¼Œåœ¨GitHub Actionsç¯å¢ƒä¸‹ï¼Œè¿™æ¶‰åŠä¸¤ä¸ªæ­¥éª¤ï¼š

* å°†`production_branch`å±æ€§è®¾ç½®ä¸ºè¦ç”¨ä½œç”Ÿäº§éƒ¨ç½²æºçš„æŒ‡å®šåˆ†æ”¯ã€‚
* åœ¨`trigger`ï¼ˆAzure Pipelinesï¼‰æˆ–`push: branches`ï¼ˆGitHub Actionsï¼‰ä¸‹åˆ—å‡ºæ‰€æœ‰éœ€è¦åˆ›å»ºé¢„è§ˆç¯å¢ƒçš„å…¶ä»–åˆ†æ”¯ã€‚

è‹¥éœ€ä¸ºæ‰€æœ‰åˆ†æ”¯æä¾›é¢„è§ˆç¯å¢ƒæ”¯æŒï¼Œå¯ä½¿ç”¨é€šé…ç¬¦ï¼ˆGitHub Actionsç”¨`**`ï¼ŒAzure Pipelinesç”¨`*`ï¼‰ã€‚

ä»¥ä¸‹æ˜¯ä¸€ä¸ªGitHub Actionsé…ç½®æ–‡ä»¶çš„ç¤ºä¾‹â€”â€”**ç”Ÿäº§**ç¯å¢ƒåŸºäº_main_åˆ†æ”¯æ„å»ºï¼ŒåŒæ—¶ä¸ºå…¶ä»–æŒ‡å®šåˆ†æ”¯ï¼ˆ_dev_å’Œ_staging_ï¼‰åˆ›å»ºç‹¬ç«‹çš„**é¢„è§ˆ**ç¯å¢ƒã€‚

äº†è§£å¦‚ä½•[åœ¨Azure Static Web Appsä¸­åˆ›å»ºåˆ†æ”¯é¢„è§ˆç¯å¢ƒ](https://docs.microsoft.com/en-us/azure/static-web-apps/branch-environments?tabs=github-actions)ã€‚

```
name: Azure Static Web Apps CI/CD

on:
  push:
    branches:
      - main
      - dev
      - staging
  pull_request:
    types: [opened, synchronize, reopened, closed]
    branches:
      - main

jobs:
  build_and_deploy_job:
    ...
    name: Build and Deploy Job
    steps:
      - uses: actions/checkout@v2
        with:
          submodules: true
      - name: Build And Deploy
        id: builddeploy
        uses: Azure/static-web-apps-deploy@v1
        with:
          ...
          production_branch: "main"
```

## å‘½åç¯å¢ƒ

æœ‰æ—¶ï¼Œæ‚¨å¯èƒ½éœ€è¦ä¸€ä¸ªéç”Ÿäº§çš„é¢„è§ˆç¯å¢ƒï¼Œå…¶URLä¿æŒ**ç¨³å®š**ï¼ˆä¸å…³è”ç‰¹å®šPRç¼–å·æˆ–åˆ†æ”¯åç§°ï¼‰ï¼Œä¸”ä¼šåœ¨é…ç½®æ–‡ä»¶ä¸­æ‰€æœ‰è¢«è·Ÿè¸ªåˆ†æ”¯æäº¤æ—¶è§¦å‘é‡å»ºã€‚

ä¸åˆ†æ”¯é…ç½®ç±»ä¼¼ï¼Œè¿™éœ€è¦æ‰‹åŠ¨ä¿®æ”¹é»˜è®¤é…ç½®æ–‡ä»¶ï¼ˆGitHub Actionsæˆ–Azure Pipelinesï¼‰ï¼Œå¦‚[æ­¤ç¤ºä¾‹æ‰€ç¤º](https://docs.microsoft.com/en-us/azure/static-web-apps/named-environments?tabs=github-actions#configuration)ã€‚

åœ¨GitHub Actionsåœºæ™¯ä¸­ï¼Œæ­¥éª¤å¦‚ä¸‹ï¼š

* å°†`deployment_environment`å±æ€§ï¼ˆåœ¨ç›¸å…³æ„å»ºä»»åŠ¡ä¸­ï¼‰è®¾ä¸ºæ­¤é¢„è§ˆç¯å¢ƒçš„**åç§°**ã€‚
* åœ¨`push: branches`ä¸‹åˆ—å‡ºä¸æ­¤å‘½åç¯å¢ƒå…³è”çš„åˆ†æ”¯â€”â€”è¿™äº›åˆ†æ”¯çš„æäº¤å°†è§¦å‘è¯¥ç¯å¢ƒçš„é‡å»ºå’Œéƒ¨ç½²ã€‚

è¿™æ˜¯ä¸€ä¸ªGitHub Actionsé…ç½®ç¤ºä¾‹â€”â€”åˆ›å»ºåä¸º**release**çš„å‘½åç¯å¢ƒï¼Œå½“**ä»»æ„**åˆ†æ”¯å‘ç”Ÿå˜æ›´æ—¶ï¼ˆé€šè¿‡`**`é€šé…ç¬¦å®ç°ï¼‰ï¼Œè¯¥ç¯å¢ƒä¼šæ›´æ–°å¹¶éƒ¨ç½²è‡³ç±»ä¼¼`<DEFAULT_HOST_NAME>-release.<LOCATION>.azurestaticapps.net`çš„URLã€‚

äº†è§£[Azure Static Web Appsä¸­çš„å‘½åé¢„è§ˆç¯å¢ƒ](https://docs.microsoft.com/en-us/azure/static-web-apps/named-environments?tabs=github-actions)

```
name: Azure Static Web Apps CI/CD

on:
  push:
    branches:
      - "**"
  pull_request:
    types: [opened, synchronize, reopened, closed]
    branches:
      - main

jobs:
  build_and_deploy_job:
    ...
    name: Build and Deploy Job
    steps:
      - uses: actions/checkout@v2
        with:
          submodules: true
      - name: Build And Deploy
        id: builddeploy
        uses: Azure/static-web-apps-deploy@v1
        with:
          ...
          deployment_environment: "release"
```

## è‡ªå®šä¹‰åŸŸå

æ‚¨å¯èƒ½å·²æ³¨æ„åˆ°ï¼Œé»˜è®¤éƒ¨ç½²URLï¼ˆç”Ÿäº§ç¯å¢ƒå½¢å¦‚`XXX.azurestaticapps.net`ï¼Œé¢„è§ˆç¯å¢ƒå½¢å¦‚`XXX.<LOCATION>.azurestaticapps.net`ï¼‰å¹¶ä¸ä¾¿äºç”¨æˆ·è®°å¿†å’Œä½¿ç”¨ã€‚

æ·»åŠ è‡ªå®šä¹‰åŸŸåå¯è§£å†³æ­¤é—®é¢˜ã€‚Azure Static Appsæ”¯æŒé…ç½®**å­åŸŸå**å’Œ**æ ¹åŸŸå**ï¼ä¾‹å¦‚ï¼Œå¯¹äºåŸŸå`www.azure.com`ï¼Œ`azure.com`æ˜¯æ ¹åŸŸåï¼Œ`www`æ˜¯ç›¸å…³å­åŸŸåã€‚

å¦‚ä½•é…ç½®è¿™äº›åŸŸåï¼Ÿæ‚¨æœ‰ä¸¤ç§é€‰æ‹©ï¼š

* ä½¿ç”¨**å¤–éƒ¨DNSæä¾›å•†**ï¼ˆå¦‚æœæ‚¨çš„åŸŸåæ³¨å†Œå•†æ”¯æŒï¼‰
* ä½¿ç”¨**Azure DNS**ï¼ˆç®¡ç†DNSåŸŸåï¼Œå³ä½¿åŸŸåè´­è‡ªä»–å¤„ï¼‰

ä¸ºä¿æŒæœ¬æ–‡ç®€æ´ï¼Œæˆ‘ä»¬ä¸å†è¯¦è¿°æ¯ç§é€‰é¡¹ã€‚è¯·æ ¹æ®éœ€æ±‚å‚è€ƒä»¥ä¸‹é“¾æ¥ï¼š

* è®¾ç½®æ ¹åŸŸå - ä½¿ç”¨ [Azure DNS](https://docs.microsoft.com/en-us/azure/static-web-apps/apex-domain-azure-dns) | ä½¿ç”¨ [å¤–éƒ¨æä¾›å•†](https://docs.microsoft.com/en-us/azure/static-web-apps/apex-domain-external)
 * è®¾ç½®å­åŸŸå - ä½¿ç”¨ [Azure DNS](https://docs.microsoft.com/en-us/azure/static-web-apps/custom-domain-azure-dns) | ä½¿ç”¨ [å¤–éƒ¨æä¾›å•†](https://docs.microsoft.com/en-us/azure/static-web-apps/custom-domain-external)

---

## æ“ä½œæŒ‡å—ï¼šè§†é¢‘æ¼”ç¤º

æ›´å–œæ¬¢é€šè¿‡è§†é¢‘äº†è§£æ“ä½œæµç¨‹ï¼Ÿæˆ‘ä»¬ä¸ºæ‚¨å‡†å¤‡äº† [Azure æŠ€å·§ä¸çªé—¨ï¼šé™æ€ Web åº”ç”¨](https://docs.microsoft.com/en-us/shows/azure-tips-and-tricks-static-web-apps/) ç³»åˆ—ã€‚è§‚çœ‹æ­¤è§†é¢‘ï¼Œäº†è§£å¦‚ä½•ä¸ºé™æ€ Web åº”ç”¨è®¾ç½®è‡ªå®šä¹‰åŸŸåï¼

<iframe   width="560" height="315" frameborder="0"  src="https://aka.ms/docs/player?show=azure-tips-and-tricks-static-web-apps&ep=how-to-set-up-a-custom-domain-name-in-azure-static-web-apps-10-of-16--azure-tips-and-tricks-static-w"></iframe>

---

## ç»ƒä¹ ï¼šåŠ¨æ‰‹å°è¯•ï¼

**æ‹‰å–è¯·æ±‚**å¯¹äºé«˜æ•ˆå¼€å±•å¼€æºæˆ–å¤šè´¡çŒ®è€…é¡¹ç›®è‡³å…³é‡è¦ï¼Œå› æ­¤äº†è§£ Azure é™æ€åº”ç”¨å¦‚ä½•åœ¨åˆå¹¶åˆ°ç”Ÿäº§éƒ¨ç½²ä¹‹å‰ï¼Œä¸ºéªŒè¯æ‹‰å–è¯·æ±‚ä¸­çš„å˜æ›´è®¾ç½®**é¢„ç”Ÿäº§**ç¯å¢ƒéå¸¸é‡è¦ã€‚

é€šè¿‡å®Œæˆ[æœ¬æ•™ç¨‹](https://docs.microsoft.com/en-us/azure/static-web-apps/review-publish-pull-requests)ï¼Œåœ¨ç°æœ‰çš„ Azure é™æ€ Web åº”ç”¨é¡¹ç›®ä¸Šè·å¾—å®é™…æ“ä½œç»éªŒã€‚

_ç›®å‰ï¼Œæ‹‰å–è¯·æ±‚çš„åˆ†é˜¶æ®µé¢„ç”Ÿäº§ç¯å¢ƒä»…é€‚ç”¨äº GitHub Actions éƒ¨ç½² - å› æ­¤è¯·ç¡®ä¿é€‰æ‹©ä¸€ä¸ªå·²è®¾ç½®é»˜è®¤å·¥ä½œæµçš„ GitHub æ‰˜ç®¡çš„ SWA é¡¹ç›®_ã€‚

---

## å®ç”¨èµ„æº

1. [Azure é™æ€ Web åº”ç”¨ä¸­çš„é¢„è§ˆç¯å¢ƒ](https://docs.microsoft.com/en-us/azure/static-web-apps/preview-environments)
2. [æ‹‰å–è¯·æ±‚é¢„è§ˆç¯å¢ƒ](https://docs.microsoft.com/en-us/azure/static-web-apps/review-publish-pull-requests)
3. [åˆ†æ”¯é¢„è§ˆç¯å¢ƒ](https://docs.microsoft.com/en-us/azure/static-web-apps/branch-environments)
4. [å‘½åé¢„è§ˆç¯å¢ƒ](https://docs.microsoft.com/en-us/azure/static-web-apps/named-environments)
5. è§†é¢‘ç³»åˆ—ï¼š[Azure æŠ€å·§ä¸çªé—¨ - é™æ€ Web åº”ç”¨](https://docs.microsoft.com/en-us/shows/azure-tips-and-tricks-static-web-apps/)
6. [å…³äºè‡ªå®šä¹‰åŸŸå](https://docs.microsoft.com/en-us/azure/static-web-apps/custom-domain)